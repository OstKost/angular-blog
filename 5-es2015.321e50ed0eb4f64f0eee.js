(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{jkDv:function(t,e,r){"use strict";r.r(e);var i=r("ofXK"),n=r("tyNb"),s=r("3Pt+"),o=r("fXoL"),a=r("+zHE"),c=r("XNiG");let b=(()=>{class t{constructor(){this.alert$=new c.a}success(t){this.alert$.next({type:"success",text:t})}warning(t){this.alert$.next({type:"warning",text:t})}danger(t){this.alert$.next({type:"danger",text:t})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Hb({token:t,factory:t.\u0275fac}),t})();const l=function(t,e,r){return{"alert-success":t,"alert-warning":e,"alert-danger":r}};function u(t,e){if(1&t&&(o.Ob(0,"div",1),o.Ob(1,"div",2),o.rc(2),o.Nb(),o.Nb()),2&t){const t=o.Yb();o.Bb(1),o.fc("ngClass",o.ic(2,l,"success"===t.type,"warning"===t.type,"danger"===t.type)),o.Bb(1),o.tc(" ",t.text," ")}}let d=(()=>{class t{constructor(t){this.alertService=t,this.delay=5e3,this.type="success"}ngOnInit(){this.alertService.alert$.subscribe(t=>{this.text=t.text,this.type=t.type;const e=setTimeout(()=>{clearTimeout(e),this.text=""},this.delay)})}ngOnDestroy(){this.aSub&&this.aSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(b))},t.\u0275cmp=o.Fb({type:t,selectors:[["app-alert"]],inputs:{delay:"delay"},decls:1,vars:1,consts:[["class","alert-wrap",4,"ngIf"],[1,"alert-wrap"],[1,"alert",3,"ngClass"]],template:function(t,e){1&t&&o.pc(0,u,3,6,"div",0),2&t&&o.fc("ngIf",e.text)},directives:[i.l,i.j],styles:[".alert-wrap[_ngcontent-%COMP%]{z-index:200;position:fixed;top:50px;right:40px;width:250px;min-height:40px}"]}),t})();const f=function(){return["/admin","dashboard"]},m=function(){return["/admin","create"]};function p(t,e){if(1&t){const t=o.Pb();o.Ob(0,"ul"),o.Ob(1,"li",4),o.Ob(2,"a",5),o.rc(3,"Main"),o.Nb(),o.Nb(),o.Ob(4,"li",4),o.Ob(5,"a",5),o.rc(6,"Create"),o.Nb(),o.Nb(),o.Ob(7,"li"),o.Ob(8,"a",6),o.Wb("click",(function(e){return o.lc(t),o.Yb().logout(e)})),o.rc(9,"Logout"),o.Nb(),o.Nb(),o.Nb()}2&t&&(o.Bb(2),o.fc("routerLink",o.gc(2,f)),o.Bb(3),o.fc("routerLink",o.gc(3,m)))}let h=(()=>{class t{constructor(t,e){this.router=t,this.auth=e}ngOnInit(){}logout(t){t.preventDefault(),this.auth.logout(),this.router.navigate(["/admin","login"])}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(n.c),o.Lb(a.a))},t.\u0275cmp=o.Fb({type:t,selectors:[["app-admin-layout"]],decls:8,vars:1,consts:[[1,"navbar","bg-primary"],["routerLink","/"],[4,"ngIf"],[1,"container"],["routerLinkActive","active"],[3,"routerLink"],[3,"click"]],template:function(t,e){1&t&&(o.Mb(0,"app-alert"),o.Ob(1,"nav",0),o.Ob(2,"h1"),o.Ob(3,"a",1),o.rc(4,"Angular Admin"),o.Nb(),o.Nb(),o.pc(5,p,10,4,"ul",2),o.Nb(),o.Ob(6,"main",3),o.Mb(7,"router-outlet"),o.Nb()),2&t&&(o.Bb(5),o.fc("ngIf",e.auth.isAuthenticated()))},directives:[d,n.f,i.l,n.h,n.e],styles:[""]}),t})();function g(t,e){if(1&t&&(o.Ob(0,"div",9),o.rc(1),o.Nb()),2&t){const t=e.ngIf;o.Bb(1),o.tc(" ",t," ")}}function v(t,e){1&t&&(o.Ob(0,"small"),o.rc(1,"Email is required"),o.Nb())}function O(t,e){1&t&&(o.Ob(0,"small"),o.rc(1,"Not a valid email"),o.Nb())}function N(t,e){if(1&t&&(o.Ob(0,"div",10),o.pc(1,v,2,0,"small",11),o.pc(2,O,2,0,"small",11),o.Nb()),2&t){const t=o.Yb();o.Bb(1),o.fc("ngIf",t.form.get("email").errors.required),o.Bb(1),o.fc("ngIf",t.form.get("email").errors.email)}}function w(t,e){1&t&&(o.Ob(0,"small"),o.rc(1,"Password is required"),o.Nb())}function y(t,e){if(1&t&&(o.Ob(0,"small"),o.rc(1),o.Nb()),2&t){const t=o.Yb(2);o.Bb(1),o.uc("Password is too short ",t.form.get("password").errors.minlength.actualLength,"/",t.form.get("password").errors.minlength.requiredLength,"")}}function I(t,e){if(1&t&&(o.Ob(0,"div",10),o.pc(1,w,2,0,"small",11),o.pc(2,y,2,2,"small",11),o.Nb()),2&t){const t=o.Yb();o.Bb(1),o.fc("ngIf",t.form.get("password").errors.required),o.Bb(1),o.fc("ngIf",t.form.get("password").errors.minlength)}}const x=function(t){return{invalid:t}};let B=(()=>{class t{constructor(t,e,r){this.auth=t,this.router=e,this.route=r,this.submitted=!1,this.message=""}ngOnInit(){this.route.queryParams.subscribe(t=>{var e,r;(null===(e=t)||void 0===e?void 0:e.loginAgain)&&(this.message="Please enter data"),(null===(r=t)||void 0===r?void 0:r.authFailed)&&(this.message="Session expired. Please login again")}),this.form=new s.d({email:new s.b(null,[s.m.required,s.m.email]),password:new s.b(null,[s.m.required,s.m.minLength(6)])})}submit(){this.form.invalid||(this.submitted=!0,this.auth.login({email:this.form.value.email,password:this.form.value.password,returnSecureToken:!0}).subscribe(()=>{this.form.reset(),this.router.navigate(["/admin","dashboard"]),this.submitted=!1},()=>this.submitted=!1))}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(a.a),o.Lb(n.c),o.Lb(n.a))},t.\u0275cmp=o.Fb({type:t,selectors:[["app-login-page"]],decls:17,vars:13,consts:[[1,"card",3,"formGroup","ngSubmit"],["class","alert alert-danger",4,"ngIf"],[1,"form-control",3,"ngClass"],["for","email"],["type","email","name","email","id","email","formControlName","email"],["class","validation",4,"ngIf"],["for","password"],["type","password","name","password","id","password","formControlName","password"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"alert","alert-danger"],[1,"validation"],[4,"ngIf"]],template:function(t,e){1&t&&(o.Ob(0,"form",0),o.Wb("ngSubmit",(function(t){return e.submit()})),o.Ob(1,"h2"),o.rc(2,"Login to the admin panel"),o.Nb(),o.pc(3,g,2,1,"div",1),o.Zb(4,"async"),o.Ob(5,"div",2),o.Ob(6,"label",3),o.rc(7,"Email"),o.Nb(),o.Mb(8,"input",4),o.pc(9,N,3,2,"div",5),o.Nb(),o.Ob(10,"div",2),o.Ob(11,"label",6),o.rc(12,"Password"),o.Nb(),o.Mb(13,"input",7),o.pc(14,I,3,2,"div",5),o.Nb(),o.Ob(15,"button",8),o.rc(16,"Login"),o.Nb(),o.Nb()),2&t&&(o.fc("formGroup",e.form),o.Bb(3),o.fc("ngIf",o.ac(4,7,e.auth.error$)),o.Bb(2),o.fc("ngClass",o.hc(9,x,e.form.get("email").touched&&e.form.get("email").invalid)),o.Bb(4),o.fc("ngIf",e.form.get("email").touched&&e.form.get("email").invalid),o.Bb(1),o.fc("ngClass",o.hc(11,x,e.form.get("password").touched&&e.form.get("password").invalid)),o.Bb(4),o.fc("ngIf",e.form.get("password").touched&&e.form.get("password").invalid),o.Bb(1),o.fc("disabled",e.form.invalid||e.submitted))},directives:[s.n,s.j,s.e,i.l,i.j,s.a,s.i,s.c],pipes:[i.b],styles:["form.card[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}"]}),t})();var S=r("ZBX8"),C=r("CzEO");function L(t,e){1&t&&(o.Ob(0,"small"),o.rc(1,"Title is required"),o.Nb())}function P(t,e){if(1&t&&(o.Ob(0,"div",10),o.pc(1,L,2,0,"small",11),o.Nb()),2&t){const t=o.Yb();o.Bb(1),o.fc("ngIf",t.form.get("title").errors.required)}}function k(t,e){1&t&&(o.Ob(0,"small"),o.rc(1,"Author is required"),o.Nb())}function q(t,e){if(1&t&&(o.Ob(0,"div",10),o.pc(1,k,2,0,"small",11),o.Nb()),2&t){const t=o.Yb();o.Bb(1),o.fc("ngIf",t.form.get("author").errors.required)}}const M=function(t){return{invalid:t}};let A=(()=>{class t{constructor(t,e){this.postsService=t,this.alert=e}ngOnInit(){this.form=new s.d({title:new s.b(null,s.m.required),text:new s.b(null,s.m.required),author:new s.b(null,s.m.required)})}submit(){if(this.form.invalid)return;const t={title:this.form.value.title,text:this.form.value.text,author:this.form.value.author,date:new Date};this.postsService.create(t).subscribe(()=>{this.form.reset(),this.alert.success("Post was created")})}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(S.a),o.Lb(b))},t.\u0275cmp=o.Fb({type:t,selectors:[["app-create-page"]],decls:19,vars:10,consts:[[1,"card",3,"formGroup","ngSubmit"],[1,"form-control",3,"ngClass"],["for","title"],["type","text","name","title","id","title","formControlName","title"],["class","validation",4,"ngIf"],[1,"form-control"],["formControlName","text"],["for","author"],["type","text","name","author","id","author","formControlName","author"],["type","submit",1,"btn","btn-block","btn-dark",3,"disabled"],[1,"validation"],[4,"ngIf"]],template:function(t,e){1&t&&(o.Ob(0,"form",0),o.Wb("ngSubmit",(function(t){return e.submit()})),o.Ob(1,"h2"),o.rc(2,"Create new Post"),o.Nb(),o.Ob(3,"div",1),o.Ob(4,"label",2),o.rc(5,"Title"),o.Nb(),o.Mb(6,"input",3),o.pc(7,P,2,1,"div",4),o.Nb(),o.Ob(8,"div",5),o.Ob(9,"label"),o.rc(10,"Post content"),o.Nb(),o.Mb(11,"quill-editor",6),o.Nb(),o.Ob(12,"div",1),o.Ob(13,"label",7),o.rc(14,"Author"),o.Nb(),o.Mb(15,"input",8),o.pc(16,q,2,1,"div",4),o.Nb(),o.Ob(17,"button",9),o.rc(18,"Create post"),o.Nb(),o.Nb()),2&t&&(o.fc("formGroup",e.form),o.Bb(3),o.fc("ngClass",o.hc(6,M,e.form.get("title").touched&&e.form.get("title").invalid)),o.Bb(4),o.fc("ngIf",e.form.get("title").touched&&e.form.get("title").invalid),o.Bb(5),o.fc("ngClass",o.hc(8,M,e.form.get("author").touched&&e.form.get("author").invalid)),o.Bb(4),o.fc("ngIf",e.form.get("author").touched&&e.form.get("author").invalid),o.Bb(1),o.fc("disabled",e.form.invalid))},directives:[s.n,s.j,s.e,i.j,s.a,s.i,s.c,i.l,C.a],styles:["form.card[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}"]}),t})();var Y=r("eIep");function j(t,e){1&t&&(o.Ob(0,"small"),o.rc(1,"Title is required"),o.Nb())}function F(t,e){if(1&t&&(o.Ob(0,"div",10),o.pc(1,j,2,0,"small",11),o.Nb()),2&t){const t=o.Yb(2);o.Bb(1),o.fc("ngIf",t.form.get("title").errors.required)}}const E=function(t){return{invalid:t}};function D(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div"),o.Ob(1,"form",2),o.Wb("ngSubmit",(function(e){return o.lc(t),o.Yb().submit()})),o.Ob(2,"div",3),o.Ob(3,"label",4),o.rc(4,"Title"),o.Nb(),o.Mb(5,"input",5),o.pc(6,F,2,1,"div",6),o.Nb(),o.Ob(7,"div",7),o.Ob(8,"label"),o.rc(9,"Post content"),o.Nb(),o.Mb(10,"quill-editor",8),o.Nb(),o.Ob(11,"button",9),o.rc(12,"Save post"),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=o.Yb();o.Bb(1),o.fc("formGroup",t.form),o.Bb(1),o.fc("ngClass",o.hc(4,E,t.form.get("title").touched&&t.form.get("title").invalid)),o.Bb(4),o.fc("ngIf",t.form.get("title").touched&&t.form.get("title").invalid),o.Bb(5),o.fc("disabled",t.form.invalid||t.submitted)}}function T(t,e){1&t&&(o.Ob(0,"p",12),o.rc(1,"Loading..."),o.Nb())}let $=(()=>{class t{constructor(t,e,r){this.route=t,this.postsService=e,this.alert=r,this.submitted=!1}ngOnInit(){this.route.params.pipe(Object(Y.a)(t=>this.postsService.getById(t.id))).subscribe(t=>{this.post=t,this.form=new s.d({title:new s.b(t.title,s.m.required),text:new s.b(t.text,s.m.required)})})}ngOnDestroy(){this.uSub&&this.uSub.unsubscribe()}submit(){this.form.invalid||(this.submitted=!0,this.uSub=this.postsService.update(Object.assign(Object.assign({},this.post),{title:this.form.value.title,text:this.form.value.text})).subscribe(()=>{this.submitted=!1,this.alert.success("Post was saved")},t=>{this.submitted=!1,this.alert.danger("Error while saving post")}))}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(n.a),o.Lb(S.a),o.Lb(b))},t.\u0275cmp=o.Fb({type:t,selectors:[["app-edit-page"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],[3,"formGroup","ngSubmit"],[1,"form-control",3,"ngClass"],["for","title"],["type","text","name","title","id","title","formControlName","title"],["class","validation",4,"ngIf"],[1,"form-control"],["formControlName","text"],["type","submit",1,"btn","btn-primary","btn-success",3,"disabled"],[1,"validation"],[4,"ngIf"],[1,"text-center"]],template:function(t,e){if(1&t&&(o.pc(0,D,13,6,"div",0),o.pc(1,T,2,0,"ng-template",null,1,o.qc)),2&t){const t=o.kc(2);o.fc("ngIf",e.form)("ngIfElse",t)}},directives:[i.l,s.n,s.j,s.e,i.j,s.a,s.i,s.c,C.a],styles:[""]}),t})(),G=(()=>{class t{transform(t,e=""){return e.trim()?t.filter(t=>t.title.toLowerCase().includes(e.toLowerCase())):t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Kb({name:"searchPost",type:t,pure:!0}),t})();const W=function(t){return["/admin","post",t,"edit"]};function X(t,e){if(1&t){const t=o.Pb();o.Ob(0,"tr"),o.Ob(1,"td"),o.rc(2),o.Nb(),o.Ob(3,"td"),o.rc(4),o.Nb(),o.Ob(5,"td"),o.rc(6),o.Nb(),o.Ob(7,"td"),o.rc(8),o.Zb(9,"date"),o.Nb(),o.Ob(10,"td"),o.Ob(11,"button",5),o.rc(12,"Open"),o.Nb(),o.Ob(13,"a",6),o.Wb("click",(function(r){o.lc(t);const i=e.$implicit;return o.Yb(2).remove(i.id)})),o.rc(14,"Delete"),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=e.$implicit,r=e.index;o.Bb(2),o.sc(r+1),o.Bb(2),o.sc(t.author),o.Bb(2),o.sc(t.title),o.Bb(2),o.sc(o.cc(9,5,t.date,"medium",null,"ru")),o.Bb(3),o.fc("routerLink",o.hc(10,W,t.id))}}function Z(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div"),o.Ob(1,"div",2),o.Ob(2,"input",3),o.Wb("ngModelChange",(function(e){return o.lc(t),o.Yb().search=e})),o.Nb(),o.Nb(),o.Ob(3,"table"),o.Ob(4,"thead"),o.Ob(5,"tr"),o.Ob(6,"th"),o.rc(7,"#"),o.Nb(),o.Ob(8,"th"),o.rc(9,"Author"),o.Nb(),o.Ob(10,"th"),o.rc(11,"Name"),o.Nb(),o.Ob(12,"th"),o.rc(13,"Date"),o.Nb(),o.Ob(14,"th"),o.rc(15,"Action"),o.Nb(),o.Nb(),o.Nb(),o.Ob(16,"tbody"),o.pc(17,X,15,12,"tr",4),o.Zb(18,"searchPost"),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=o.Yb();o.Bb(2),o.fc("ngModel",t.search),o.Bb(15),o.fc("ngForOf",o.bc(18,2,t.posts,t.search))}}function _(t,e){1&t&&(o.Ob(0,"p",7),o.rc(1,"Loading..."),o.Nb())}let z=(()=>{class t{constructor(t,e){this.postsService=t,this.alert=e,this.posts=[],this.search=""}ngOnInit(){this.pSub=this.postsService.getAll().subscribe(t=>{this.posts=t})}ngOnDestroy(){this.pSub&&this.pSub.unsubscribe(),this.dSub&&this.dSub.unsubscribe()}remove(t){this.dSub=this.postsService.remove(t).subscribe(()=>{this.posts=this.posts.filter(e=>e.id!==t),this.alert.success("Post was deleted")})}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(S.a),o.Lb(b))},t.\u0275cmp=o.Fb({type:t,selectors:[["app-dashboard-page"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],[1,"form-control"],["type","text","name","find","id","find","placeholder","Find post",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[1,"btn","btn-link","open",3,"routerLink"],[3,"click"],[1,"text-center"]],template:function(t,e){if(1&t&&(o.pc(0,Z,19,5,"div",0),o.pc(1,_,2,0,"ng-template",null,1,o.qc)),2&t){const t=o.kc(2);o.fc("ngIf",e.posts.length)("ngIfElse",t)}},directives:[i.l,s.a,s.i,s.k,i.k,n.d],pipes:[G,i.e],styles:["button.open[_ngcontent-%COMP%]{margin-right:10px}"]}),t})();var H=r("PCNd");let J=(()=>{class t{constructor(t,e){this.auth=t,this.router=e}canActivate(t,e){if(this.auth.isAuthenticated())return!0;this.auth.logout(),this.router.navigate(["/admin","login"],{queryParams:{loginAgain:!0}})}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(a.a),o.Sb(n.c))},t.\u0275prov=o.Hb({token:t,factory:t.\u0275fac}),t})();r.d(e,"AdminModule",(function(){return Q}));const K=[{path:"",component:h,children:[{path:"",redirectTo:"/admin/login",pathMatch:"full"},{path:"login",component:B},{path:"post/:id/edit",component:$,canActivate:[J]},{path:"create",component:A,canActivate:[J]},{path:"dashboard",component:z,canActivate:[J]}]}];let Q=(()=>{class t{}return t.\u0275mod=o.Jb({type:t}),t.\u0275inj=o.Ib({factory:function(e){return new(e||t)},providers:[J,b],imports:[[i.c,n.g.forChild(K),s.f,s.l,H.a],n.g]}),t})()}}]);